var vzUrl={regex:RegExp("^((https?|ftp)://[\\w\\-_]+(\\.[\\w\\-_]+)+|/)([\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\w\\-\\@?^=%!&amp;/~\\+#])?$","gi"),init:function(a){$(document).on("keyup paste",".vz_url_field",function(a){vzUrl.check_field.call(a.target,!0)});$(".vz_url_field").each(vzUrl.check_field);"undefined"!==typeof Grid&&Grid.bind("vz_url","display",function(a){vzUrl.check_field.call(a.find("input"))});"undefined"!==typeof Matrix&&Matrix.bind("vz_url","display",function(a){vzUrl.check_field.call(this.find("input"))})},
check_field:function(a){$field=$(this);a&&vzUrl.timer&&clearTimeout(vzUrl.timer);"http://"===$field.val()||""===$field.val()?vzUrl.set_status($field,"empty"):(vzUrl.set_status($field,"checking"),a?vzUrl.timer=setTimeout(function(){vzUrl.validate($field)},500):vzUrl.validate($field))},validate:function(a){var b=vzUrl.encode_uri(a.val());b.match(vzUrl.regex)?a.hasClass("local")&&"/"!=b.substr(0,1)&&-1==b.indexOf(document.domain)?vzUrl.set_status(a,"nonlocal"):(b=b.replace("http",""),$.getJSON(vzUrl_settings.actionUrl+
"&callback=?",{url:b},function(b){b.original==vzUrl.encode_uri(a.val())&&(200<=b.http_code&&400>b.http_code?b.original==b.final_url?vzUrl.set_status(a,"valid"):vzUrl.set_status(a,"redirect",b):vzUrl.set_status(a,"invalid"))})):vzUrl.set_status(a,"invalid")},set_status:function(a,b,d){a.removeClass("empty checking invalid valid nonlocal redirect");a.prev().remove();var c=a.next().empty();switch(b){case "invalid":c.html(vzUrl_settings.errorText);break;case "nonlocal":c.html(vzUrl_settings.nonlocalText);
break;case "redirect":a.hasClass("show_redirect")?(c.html(vzUrl_settings.redirectText+" "+d.final_url),$("<a/>",{text:vzUrl_settings.redirectUpdate,href:"#","data-final_url":d.final_url,click:function(b){a.val($(this).attr("data-final_url"));vzUrl.validate(a);return!1}}).appendTo(c)):b="valid"}a.addClass(b);"valid"!==b&&"redirect"!==b||a.before('<a href="'+a.val()+'" class="vz_url_visit" target="_blank">'+vzUrl_settings.openText+"</a>")},encode_uri:function(a){return encodeURI(a).replace(/%25/g,"%").replace(/%5B/g,
"[").replace(/%5D/g,"]")}};vzUrl.init();